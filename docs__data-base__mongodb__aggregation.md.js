(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[34],{TqRt:function(e,n){function a(e){return e&&e.__esModule?e:{default:e}}e.exports=a},VxW0:function(e,n,a){"use strict";a.r(n);var l=a("q1tI"),t=a.n(l),c=a("dEAq"),r=(a("vg9a"),a("ZpkN")),m=t.a.memo((function(){var e=a("TqRt"),n=e(a("q1tI")),l=e(a("fyah")),t=function(){return n["default"].createElement("img",{src:l["default"],width:720})};return n["default"].createElement(t)}));n["default"]=function(){return t.a.createElement(t.a.Fragment,null,t.a.createElement(t.a.Fragment,null,t.a.createElement("div",{className:"markdown"},t.a.createElement("h1",{id:"\u805a\u5408\u7ba1\u9053"},t.a.createElement(c["AnchorLink"],{to:"#\u805a\u5408\u7ba1\u9053","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u805a\u5408\u7ba1\u9053"),t.a.createElement("p",null,"\u5148\u4ecb\u7ecd\u7ba1\u9053\u7684\u6982\u5ff5\uff0c\u5728 POSIX \u591a\u7ebf\u7a0b\u7684\u4f7f\u7528\u65b9\u5f0f\u4e2d\uff0c\u5b9a\u4e49\u4e86\u4e00\u79cd\u91cd\u8981\u7684 pipeline \u65b9\u5f0f\uff0c\u6210\u4e3a ",t.a.createElement("strong",null,"\u6d41\u6c34\u7ebf")," \u6216 ",t.a.createElement("strong",null,"\u7ba1\u9053"),"\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u5f97\u6570\u636e\u88ab\u4e00\u7ec4\u7ebf\u7a0b\u987a\u5e8f\u6267\u884c\u3002"),t.a.createElement(r["a"],{code:"Input -> ThreadA -> ThreadB -> ThreadC -> Output\n",lang:"unknown"}),t.a.createElement("p",null,"\u4ee5\u9762\u5411\u5bf9\u8c61\u7684\u601d\u60f3\u53bb\u7406\u89e3\uff0c\u6574\u4e2a\u6d41\u6c34\u7ebf\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6570\u636e\u4f20\u8f93\u7684\u7ba1\u9053\uff1b\u8be5\u7ba1\u9053\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6574\u4e2a\u6d41\u6c34\u7ebf\u7684\u4e00\u4e2a\u5de5\u4f5c\u9636\u6bb5 stage\uff0c\u8fd9\u4e9b\u5de5\u4f5c\u7ebf\u7a0b\u4e4b\u95f4\u7684\u5408\u4f5c\u662f\u4e00\u73af\u6263\u4e00\u73af\u7684\u3002\u9760\u8f93\u5165\u53e3\u8d8a\u8fd1\u7684\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u662f\u65f6\u5e8f\u8f83\u65e9\u7684\u5de5\u4f5c\u9636\u6bb5 stage\uff0c\u5b83\u7684\u5de5\u4f5c\u6210\u679c\u4f1a\u5f71\u54cd\u4e0b\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u9636\u6bb5\uff08stage\uff09\u7684\u5de5\u4f5c\u7ed3\u679c\uff0c\u5373\u4e0b\u4e2a\u9636\u6bb5\u4f9d\u8d56\u4e8e\u4e0a\u4e00\u4e2a\u9636\u6bb5\u7684\u8f93\u51fa\uff0c\u4e0a\u4e00\u4e2a\u9636\u6bb5\u7684\u8f93\u51fa\u6210\u4e3a\u672c\u9636\u6bb5\u7684\u8f93\u5165\u3002\u8fd9\u4e5f\u662f pipeline \u7684\u4e00\u4e2a\u5171\u6709\u7279\u70b9\u3002"),t.a.createElement("h2",{id:"\u805a\u5408\u6846\u67b6"},t.a.createElement(c["AnchorLink"],{to:"#\u805a\u5408\u6846\u67b6","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u805a\u5408\u6846\u67b6"),t.a.createElement("p",null,"Mongodb \u5728  2.2 \u7248\u672c\u4e2d\u5f15\u5165\u4e86 ",t.a.createElement("strong",null,"\u805a\u5408\u6846\u67b6"),"\uff08aggregate framework\uff09\u7684\u65b0\u529f\u80fd\uff0c\u5b83\u662f\u805a\u5408\u7684\u65b0\u6846\u67b6\uff0c\u5176\u6982\u5ff5\u7c7b\u4f3c\u4e8e\u6570\u636e\u5904\u7406\u7684\u7ba1\u9053\uff0c\u6bcf\u4e2a\u6587\u6863\u7ecf\u8fc7\u4e00\u4e2a\u7531\u591a\u4e2a\u8282\u70b9\u7ec4\u6210\u7684\u7ba1\u9053\uff0c\u6bcf\u4e2a\u8282\u70b9\u76f8\u5f53\u4e8e\u6d41\u6c34\u7ebf\u4e2d\u7684\u4e00\u4e2a stage\uff0c\u6709\u81ea\u5df1\u7684\u529f\u80fd\uff08\u5206\u7ec4\u3001\u8fc7\u6ee4\u7b49\uff09\uff0c\u6587\u6863\u7ecf\u8fc7\u7ba1\u9053\u5904\u7406\u540e\uff0c\u6700\u540e\u8f93\u51fa\u76f8\u5e94\u7684\u7ed3\u679c\uff0c\u7ba1\u9053\u7684\u57fa\u672c\u529f\u80fd\u6709\u4e24\u4e2a\uff1a"),t.a.createElement("ol",null,t.a.createElement("li",null,"\u5bf9\u6587\u6863\u8fdb\u884c",t.a.createElement("strong",null,"\u8fc7\u6ee4"),"\uff0c\u7b5b\u9009\u51fa\u5408\u9002\u7684\u6587\u6863"),t.a.createElement("li",null,"\u5bf9\u6587\u6863\u8fdb\u884c",t.a.createElement("strong",null,"\u53d8\u6362"),"\uff0c\u6539\u53d8\u6587\u6863\u7684\u8f93\u51fa\u5f62\u5f0f")),t.a.createElement("p",null,"\u5176\u4ed6\u7684\u4e00\u4e9b\u529f\u80fd\u8fd8\u5305\u62ec\u6309\u7167\u67d0\u4e2a\u6307\u5b9a\u7684\u5b57\u6bb5\u5206\u7ec4\u548c\u6392\u5e8f\u7b49\u3002\u800c\u4e14\u5728\u6bcf\u4e2a\u9636\u6bb5\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\u8ba1\u7b97\u5e73\u5747\u503c\u548c\u62fc\u63a5\u5b57\u7b26\u4e32\u7b49\u76f8\u5173\u64cd\u4f5c\u3002"),t.a.createElement("p",null,"\u7ba1\u9053\u63d0\u4f9b\u4e86\u4e00\u4e2a MapReduce \u7684\u66ff\u4ee3\u65b9\u6848\uff0cMapReduce \u4f7f\u7528\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u590d\u6742\uff0c\u800c\u7ba1\u9053\u7684\u62e5\u6709\u56fa\u5b9a\u7684\u63a5\u53e3\uff08\u64cd\u4f5c\u7b26\u8868\u8fbe\uff09\uff0c\u4f7f\u7528\u6bd4\u8f83\u7b80\u5355\uff0c\u5bf9\u4e8e\u5927\u591a\u6570\u7684\u805a\u5408\u4efb\u52a1\u7ba1\u9053\u4e00\u822c\u6765\u8bf4\u662f\u9996\u9009\u65b9\u6cd5\u3002"),t.a.createElement("p",null,"MongoDB \u4e2d\u7684\u805a\u5408\u4e3b\u8981\u7528\u4e8e\u7b80\u5355\u7684\u6570\u636e\u5904\u7406\uff08\u5e73\u5747\u503c\uff0c\u6c42\u548c\u7b49\uff09\uff0c\u5e76\u8fd4\u56de\u8ba1\u7b97\u540e\u7684\u6570\u636e\u7ed3\u679c\uff0c\u7c7b\u4f3c\u4e8e SQL \u4e2d\u7684\u5185\u5d4c\u51fd\u6570\uff08",t.a.createElement("code",null,"count()")," \u7b49\uff09\u3002"),t.a.createElement("p",null,"\ud83c\udf30 MongoDB \u5b98\u7f51\u7ed9\u51fa\u4e86\u805a\u5408\u6846\u67b6\u7684\u5e94\u7528\u5b9e\u4f8b\uff1a")),t.a.createElement(m,null),t.a.createElement("div",{className:"markdown"},t.a.createElement("h2",{id:"\u805a\u5408\u8868\u8fbe\u5f0f"},t.a.createElement(c["AnchorLink"],{to:"#\u805a\u5408\u8868\u8fbe\u5f0f","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u805a\u5408\u8868\u8fbe\u5f0f"),t.a.createElement("h3",{id:"\u5b57\u6bb5\u8def\u5f84\u8868\u8fbe\u5f0f"},t.a.createElement(c["AnchorLink"],{to:"#\u5b57\u6bb5\u8def\u5f84\u8868\u8fbe\u5f0f","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u5b57\u6bb5\u8def\u5f84\u8868\u8fbe\u5f0f"),t.a.createElement("table",null,t.a.createElement("thead",null,t.a.createElement("tr",null,t.a.createElement("th",null,"\u5b57\u6bb5\u8def\u5f84\u8868\u8fbe\u5f0f"),t.a.createElement("th",null,"\u8bf4\u660e"))),t.a.createElement("tbody",null,t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$<field>")),t.a.createElement("td",null,"\u4f7f\u7528 ",t.a.createElement("code",null,"$")," \u6765\u6307\u793a\u5b57\u6bb5\u8def\u5f84")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$<field>.<sub-field>")),t.a.createElement("td",null,"\u4f7f\u7528 ",t.a.createElement("code",null,"$")," \u548c ",t.a.createElement("code",null,".")," \u6765\u6307\u793a\u5185\u5d4c\u6587\u6863\u5b57\u6bb5\u8def\u5f84")))),t.a.createElement("h3",{id:"\u7cfb\u7edf\u53d8\u91cf\u8868\u8fbe\u5f0f"},t.a.createElement(c["AnchorLink"],{to:"#\u7cfb\u7edf\u53d8\u91cf\u8868\u8fbe\u5f0f","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u7cfb\u7edf\u53d8\u91cf\u8868\u8fbe\u5f0f"),t.a.createElement("table",null,t.a.createElement("thead",null,t.a.createElement("tr",null,t.a.createElement("th",null,"\u7cfb\u7edf\u53d8\u91cf\u8868\u8fbe\u5f0f"),t.a.createElement("th",null,"\u8bf4\u660e"))),t.a.createElement("tbody",null,t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$$<variable>")),t.a.createElement("td",null,"\u4f7f\u7528 ",t.a.createElement("code",null,"$$")," \u6765\u6307\u793a\u7cfb\u7edf\u53d8\u91cf")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$$CURRENT")),t.a.createElement("td",null,"\u6307\u793a\u7ba1\u9053\u4e2d\u5f53\u524d\u64cd\u4f5c\u7684\u6587\u6863")))),t.a.createElement("h3",{id:"\u5e38\u91cf\u8868\u8fbe\u5f0f"},t.a.createElement(c["AnchorLink"],{to:"#\u5e38\u91cf\u8868\u8fbe\u5f0f","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u5e38\u91cf\u8868\u8fbe\u5f0f"),t.a.createElement("table",null,t.a.createElement("thead",null,t.a.createElement("tr",null,t.a.createElement("th",null,"\u5e38\u91cf\u8868\u8fbe\u5f0f"),t.a.createElement("th",null,"\u8bf4\u660e"))),t.a.createElement("tbody",null,t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$literal: <value>")),t.a.createElement("td",null,"\u6307\u793a\u5e38\u91cf ",t.a.createElement("code",null,"<value>"))),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,'$literal: "$name"')),t.a.createElement("td",null,'\u6307\u793a\u5e38\u91cf\u5b57\u7b26\u4e32 "',t.a.createElement("span",{className:["math","math-inline"]},t.a.createElement("span",{className:["katex"]},t.a.createElement("span",{className:["katex-mathml"]},t.a.createElement("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},t.a.createElement("semantics",null,t.a.createElement("mrow",null,t.a.createElement("mi",null,"n"),t.a.createElement("mi",null,"a"),t.a.createElement("mi",null,"m"),t.a.createElement("mi",null,"e"),t.a.createElement("mi",{mathvariant:"normal"},'"'),t.a.createElement("mo",null,"<"),t.a.createElement("mi",null,"b"),t.a.createElement("mi",null,"r"),t.a.createElement("mi",{mathvariant:"normal"},"/"),t.a.createElement("mo",null,">"),t.a.createElement("mtext",null,"\u8fd9\u91cc\u7684"),t.a.createElement("mi",{mathvariant:"normal"},"\u2018")),t.a.createElement("annotation",{encoding:"application/x-tex"},'name"<br/>\u8fd9\u91cc\u7684 `')))),t.a.createElement("span",{className:["katex-html"],"aria-hidden":"true"},t.a.createElement("span",{className:["base"]},t.a.createElement("span",{className:["strut"],style:{height:"0.73354em",verticalAlign:"-0.0391em"}}),t.a.createElement("span",{className:["mord","mathnormal"]},"n"),t.a.createElement("span",{className:["mord","mathnormal"]},"a"),t.a.createElement("span",{className:["mord","mathnormal"]},"m"),t.a.createElement("span",{className:["mord","mathnormal"]},"e"),t.a.createElement("span",{className:["mord"]},'"'),t.a.createElement("span",{className:["mspace"],style:{marginRight:"0.2777777777777778em"}}),t.a.createElement("span",{className:["mrel"]},"<"),t.a.createElement("span",{className:["mspace"],style:{marginRight:"0.2777777777777778em"}})),t.a.createElement("span",{className:["base"]},t.a.createElement("span",{className:["strut"],style:{height:"1em",verticalAlign:"-0.25em"}}),t.a.createElement("span",{className:["mord","mathnormal"]},"b"),t.a.createElement("span",{className:["mord","mathnormal"],style:{marginRight:"0.02778em"}},"r"),t.a.createElement("span",{className:["mord"]},"/"),t.a.createElement("span",{className:["mspace"],style:{marginRight:"0.2777777777777778em"}}),t.a.createElement("span",{className:["mrel"]},">"),t.a.createElement("span",{className:["mspace"],style:{marginRight:"0.2777777777777778em"}})),t.a.createElement("span",{className:["base"]},t.a.createElement("span",{className:["strut"],style:{height:"0.69444em",verticalAlign:"0em"}}),t.a.createElement("span",{className:["mord","cjk_fallback"]},"\u8fd9"),t.a.createElement("span",{className:["mord","cjk_fallback"]},"\u91cc"),t.a.createElement("span",{className:["mord","cjk_fallback"]},"\u7684"),t.a.createElement("span",{className:["mord"]},"\u2018"))))),"` \u88ab\u5f53\u4f5c\u5e38\u91cf\u5904\u7406\uff0c\u800c\u4e0d\u662f\u5b57\u6bb5\u8def\u5f84\u8868\u8fbe\u5f0f")))),t.a.createElement("h3",{id:"\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26"},t.a.createElement(c["AnchorLink"],{to:"#\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26"),t.a.createElement("table",null,t.a.createElement("thead",null,t.a.createElement("tr",null,t.a.createElement("th",null,"\u5e38\u7528\u8868\u8fbe\u5f0f"),t.a.createElement("th",null,"\u8bf4\u660e"))),t.a.createElement("tbody",null,t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$sum")),t.a.createElement("td",null,"\u8ba1\u7b97\u603b\u548c\uff0c",t.a.createElement("code",null,"{","$sum: 1","}")," \u8868\u793a\u8fd4\u56de\u603b\u548c x 1 \u7684\u503c\uff0c\u4f7f\u7528 ",t.a.createElement("code",null,"{"," $sum: '$\u6307\u5b9a\u5b57\u6bb5' ","}")," \u4e5f\u80fd\u76f4\u63a5\u83b7\u53d6\u6307\u5b9a\u5b57\u6bb5\u7684\u503c\u7684\u603b\u548c")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$avg")),t.a.createElement("td",null,"\u6c42\u5e73\u5747\u503c")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$min")),t.a.createElement("td",null,"\u6c42\u6700\u5c0f\u503c")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$max")),t.a.createElement("td",null,"\u6c42\u6700\u5927\u503c")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$push")),t.a.createElement("td",null,"\u5c06\u7ed3\u679c\u6587\u6863\u4e2d\u63d2\u5165\u503c\u5230\u4e00\u4e2a\u6570\u7ec4\u4e2d")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$first")),t.a.createElement("td",null,"\u6839\u636e\u6587\u6863\u7684\u6392\u5e8f\u83b7\u53d6\u7b2c\u4e00\u4e2a\u6587\u6863\u6570\u636e")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement("code",null,"$last")),t.a.createElement("td",null,"\u540c\u7406\uff0c\u83b7\u53d6\u6700\u540e\u4e00\u4e2a\u6587\u6863\u6570\u636e")))),t.a.createElement("h3",{id:"\u805a\u5408\u7ba1\u9053\u9636\u6bb5"},t.a.createElement(c["AnchorLink"],{to:"#\u805a\u5408\u7ba1\u9053\u9636\u6bb5","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u805a\u5408\u7ba1\u9053\u9636\u6bb5"),t.a.createElement("table",null,t.a.createElement("thead",null,t.a.createElement("tr",null,t.a.createElement("th",null,"\u805a\u5408\u7ba1\u9053\u8868\u8fbe\u5f0f"),t.a.createElement("th",null,"\u8bf4\u660e"),t.a.createElement("th",null,"MySQL \u64cd\u4f5c/\u51fd\u6570"))),t.a.createElement("tbody",null,t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#project"},t.a.createElement("code",null,"$project"))),t.a.createElement("td",null,"\u5bf9\u8f93\u5165\u6587\u6863\u8fdb\u884c\u518d\u6b21\u6295\u5f71"),t.a.createElement("td",null,"where")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#match"},t.a.createElement("code",null,"$match"))),t.a.createElement("td",null,"\u5bf9\u8f93\u5165\u6587\u6863\u8fdb\u884c\u7b5b\u9009"),t.a.createElement("td",null,"having")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#limit-%E5%92%8C-skip"},t.a.createElement("code",null,"$limit"))),t.a.createElement("td",null,"\u7b5b\u9009\u51fa\u7ba1\u9053\u5185\u524d N \u7bc7\u6587\u6863"),t.a.createElement("td",null,"limit")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#limit-%E5%92%8C-skip"},t.a.createElement("code",null,"$skip"))),t.a.createElement("td",null,"\u8df3\u8fc7\u7ba1\u9053\u5185\u524d N \u7bc7\u6587\u6863"),t.a.createElement("td",null)),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#skip"},t.a.createElement("code",null,"$unwind"))),t.a.createElement("td",null,"\u5c55\u5f00\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6570\u7ec4\u5b57\u6bb5"),t.a.createElement("td",null)),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#sort"},t.a.createElement("code",null,"$sort"))),t.a.createElement("td",null,"\u5bf9\u8f93\u5165\u6587\u6863\u8fdb\u884c\u6392\u5e8f"),t.a.createElement("td",null,"order by")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#lookup"},t.a.createElement("code",null,"$lookup"))),t.a.createElement("td",null,"\u5bf9\u8f93\u5165\u6587\u6863\u8fdb\u884c\u67e5\u8be2\u64cd\u4f5c"),t.a.createElement("td",null,"join")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#group"},t.a.createElement("code",null,"$group"))),t.a.createElement("td",null,"\u5bf9\u8f93\u5165\u6587\u6863\u8fdb\u884c\u5206\u7ec4"),t.a.createElement("td",null,"group by")),t.a.createElement("tr",null,t.a.createElement("td",null,t.a.createElement(c["AnchorLink"],{to:"#out"},t.a.createElement("code",null,"$out"))),t.a.createElement("td",null,"\u5c06\u7ba1\u9053\u4e2d\u7684\u6587\u6863\u8f93\u51fa"),t.a.createElement("td",null)))),t.a.createElement("h4",{id:"project"},t.a.createElement(c["AnchorLink"],{to:"#project","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$project"),t.a.createElement("p",null,t.a.createElement("code",null,"$project")," \u7ba1\u9053\u64cd\u4f5c\u7b26\u7528\u4e8e\u4fee\u6539\u6d41\u4e2d\u7684\u6587\u6863\u3002"),t.a.createElement("p",null,"\u5bf9\u6587\u6863\u8fdb\u884c\u91cd\u65b0\u6295\u5f71\uff0c\u4e3b\u8981\u7528\u4e8e",t.a.createElement("strong",null,"\u91cd\u547d\u540d"),"\u3001",t.a.createElement("strong",null,"\u589e\u52a0\u5b57\u5b57\u6bb5"),"\u3001",t.a.createElement("strong",null,"\u5220\u9664\u5b57\u6bb5"),"\u3002"),t.a.createElement(r["a"],{code:'# \u9690\u85cf\u6587\u6863 class \u4e3b\u952e\uff0c\u663e\u793a age \u5b57\u6bb5\u503c\n# \u6dfb\u52a0\u65b0\u5b57\u6bb5 name\uff0c\u503c\u4e3a\u539f\u6587\u6863\u4e2d\u5b57\u6bb5 info \u4e2d\u7684 name \u7684\u503c\n$ db.class.aggregate([\n  {\n    $project: {\n      _id: 0,\n      age: 1,\n      name: "$info.name",\n    }\n  }\n])\n\n# \u540c\u6837\u5730\uff0c\u9690\u85cf\u6587\u6863 class \u4e3b\u952e\uff0c\u663e\u793a age \u5b57\u6bb5\u503c\n# \u6dfb\u52a0\u65b0\u5b57\u6bb5 sub\uff0c\u5176\u6570\u636e\u7c7b\u578b\u4e3a\u6570\u7ec4\uff0c\u4e5f\u4ee5\u5bf9\u5e94 subject \u7684\u5bf9\u8c61\u952e\u503c\u586b\u5145\n# \u5f53\u4e0d\u5b58\u5728\u5b57\u6bb5\uff0c\u4f1a\u4f7f\u7528 null \u586b\u5145\n$ db.class.aggregate([\n  {\n    $project: {\n      _id: 0,\n      age: 1,\n      sub: [\n        "$subject.chinese",\n        "$subject.maths",\n        "$subject.english"\n      ]\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("p",null,t.a.createElement("code",null,"$project")," \u662f\u5f88\u5e38\u7528\u7684\u805a\u5408\u9636\u6bb5\uff0c\u53ef\u4ee5\u7528\u6765\u7075\u6d3b\u5730\u63a7\u5236\u8f93\u51fa\u6587\u6863\u7684\u683c\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528\u6765\u63d0\u51fa\u4e0d\u76f8\u5173\u7684\u5b57\u6bb5\uff0c\u4ee5\u4f18\u5316\u805a\u5408\u7ba1\u9053\u64cd\u4f5c\u7684\u6027\u80fd\u3002"),t.a.createElement("h4",{id:"match"},t.a.createElement(c["AnchorLink"],{to:"#match","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$match"),t.a.createElement("p",null,t.a.createElement("code",null,"$match")," \u4e2d\u4f7f\u7528\u7684",t.a.createElement("strong",null,"\u6587\u6863\u7b5b\u9009\u8bed\u6cd5"),"\uff0c\u548c\u8bfb\u53d6\u6587\u6863\u65f6\u7684 ",t.a.createElement("code",null,"$match")," \u8bed\u6cd5\u76f8\u540c\u3002\u4e3b\u8981\u7528\u4e8e\u8fc7\u6ee4\u3001\u7b5b\u9009\u7b26\u5408\u6761\u4ef6\u7684\u6587\u6863\uff0c\u4f5c\u4e3a\u4e0b\u4e00\u9636\u6bb5\u7684\u8f93\u5165\u3002"),t.a.createElement("p",null,"\u26a0\ufe0f ",t.a.createElement("strong",null,"\u6ce8\u610f"),"\uff1a\u7531\u4e8e ",t.a.createElement("code",null,"aggregate")," \u7ba1\u9053\u5bf9\u4e8e\u5185\u5b58\u7684\u9650\u5236\uff0c\u5728\u5904\u7406\u5927\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u6700\u597d\u5148\u7528 ",t.a.createElement("code",null,"$match")," \u64cd\u4f5c\u7b26\u8fdb\u884c\u7b5b\u9009\uff0c\u51cf\u5c11\u5185\u5b58\u5360\u7528\u3002"),t.a.createElement(r["a"],{code:'# \u5339\u914d class \u6587\u6863\u5b57\u6bb5\uff08\u5d4c\u5957\u6587\u6863\uff09 <field> \u7684\u5b57\u6bb5 <sub-field> \u7684\u503c\u4e3a <value> \u7684\u6587\u6863\n$ db.class.aggregate([\n  {\n    $match: {\n      "<field>.<sub-field>": <value>\n    }\n  }\n])\n\n$ db.class.aggregate([\n  {\n    $match: {\n      $or: [\n        {\n          <field1>: {\n            <comparasion-operator1>: <value1>,\n            <comparasion-operator2>: <value2>\n           }\n        }, {\n          "<field2>.<sub-field2>": <value3>\n        }\n      ]\n      "<field>.<sub-field>": <value>\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("p",null,t.a.createElement("code",null,"$match")," \u5e38\u5e38\u7528\u4e8e\u5254\u9664\u6216\u4fdd\u7559\u67d0\u7bc7\u6587\u6863\u3002\u5e94\u8be5\u5c3d\u91cf\u5728\u805a\u5408\u7ba1\u9053\u7684\u5f00\u59cb\u9636\u6bb5\u5e94\u7528 ",t.a.createElement("code",null,"$match"),"\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u540e\u7eed\u9636\u6bb5\u4e2d\u9700\u8981\u5904\u7406\u7684\u6587\u6863\u6570\u91cf\uff0c\u4f18\u5316\u805a\u5408\u64cd\u4f5c\u7684\u6027\u80fd\u3002"),t.a.createElement("p",null,"\u26a0\ufe0f ",t.a.createElement("strong",null,"\u6ce8\u610f\u4e8b\u9879\uff1a")),t.a.createElement("ul",null,t.a.createElement("li",null,"\u4e0d\u80fd\u5728 ",t.a.createElement("code",null,"$match")," \u64cd\u4f5c\u7b26\u4e2d\u4f7f\u7528 ",t.a.createElement("code",null,"$where")," \u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26"),t.a.createElement("li",null,t.a.createElement("code",null,"$match")," \u5e94\u8be5\u5c3d\u53ef\u80fd\u5728\u7ba1\u9053\u67e5\u8be2\u7684\u524d\u7f6e\u9636\u6bb5\uff0c\u53ef\u4ee5\u63d0\u65e9\u8fc7\u6ee4\u6587\u6863\uff0c\u51cf\u5c11\u540e\u7eed\u9636\u6bb5\u64cd\u4f5c\u6587\u6863\uff0c\u52a0\u5feb\u805a\u5408\u901f\u5ea6"),t.a.createElement("li",null,"\u5982\u679c ",t.a.createElement("code",null,"$match")," \u51fa\u73b0\u5728\u6700\u524d\u9762\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u6765\u52a0\u5feb\u67e5\u8be2")),t.a.createElement("h4",{id:"limit-\u548c-skip"},t.a.createElement(c["AnchorLink"],{to:"#limit-\u548c-skip","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"limit \u548c skip"),t.a.createElement("p",null,t.a.createElement("code",null,"$limt")," \u548c ",t.a.createElement("code",null,"$skip")," \u901a\u5e38\u5728\u4e00\u8d77\u4f7f\u7528\u3002"),t.a.createElement("p",null,t.a.createElement("code",null,"$limit")," \u7528\u4e8e\u9650\u5236\u7ecf\u8fc7\u7ba1\u9053\u7684\u6587\u6863\u7684\u6570\u91cf\u3002"),t.a.createElement("p",null,t.a.createElement("code",null,"$skip")," \u7528\u4e8e\u5f85\u64cd\u4f5c\u96c6\u5408\u5904\u7406\u524d\u8df3\u8fc7\u90e8\u5206\u7684\u6587\u6863\u3002"),t.a.createElement(r["a"],{code:"# \u7b5b\u9009 <number> \u7bc7\u6587\u6863\n$ db.<collection>.aggregate([\n  { $limit: <number> }\n])\n\n# \u8df3\u8fc7 <number> \u7bc7\u6587\u6863\n$ db.<collection>.aggregate([\n  { $skip: <number> }\n])\n",lang:"bash"}),t.a.createElement("h4",{id:"unwind"},t.a.createElement(c["AnchorLink"],{to:"#unwind","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$unwind"),t.a.createElement("p",null,"\u5c06\u6570\u7ec4\u62c6\u5206\u6210\u72ec\u7acb\u5b57\u6bb5\u3002"),t.a.createElement(r["a"],{code:'# \u5982\u679c\u539f\u6587\u6863\u4e2d\u5bf9\u5e94\u7684 <field> \u5b57\u6bb5\u662f\u6570\u7ec4\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\uff0c\u751f\u6210\u65b0\u7684\u6587\u6863\uff0c\u5bf9\u5e94\u7684 <field> \u4e3a\u5c55\u5f00\u7684\u6570\u7ec4\u6210\u5458\n# \u65b0\u751f\u6210\u7684\u6587\u6863\u6587\u6863\u4e3b\u952e\u90fd\u662f\u4e00\u81f4\u7684\uff0c\u533a\u522b\u5728\u4e8e <field> \u7684\u4e0d\u540c\n# \u5982\u679c\u539f\u6587\u6863\u4e2d\u5bf9\u5e94\u7684 <field> \u5b57\u6bb5\u4e3a\u975e\u6570\u7ec4\uff0c\u90a3\u4e48\u4e0d\u4f1a\u6709\u5176\u4ed6\u64cd\u4f5c\uff0c\u76f4\u63a5\u4fdd\u7559\u4e0b\u6765\n$ db.<collection>.aggregate([\n  {\n    $unwind: {\n      path: "$<field>"\n    }\n  }\n])\n\n# \u540c\u4e0a\uff0c\u4f46\u662f\u5c55\u5f00\u540e\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u65b0\u5b57\u6bb5 <field-item-index>\uff0c\u4e3a\u539f\u6587\u6863\u6570\u7ec4\u4e2d\u7684\u7d22\u5f15\u6570\u503c\n# \u5982\u679c\u539f\u6587\u6863\u5bf9\u5e94 <field> \u4e0d\u662f\u6570\u7ec4\u7c7b\u578b\uff0c\u65b0\u589e\u7684\u5b57\u6bb5\u9ed8\u8ba4\u586b\u5145 null\n$ db.<collection>.aggregate([\n  {\n    $unwind: {\n      path: "$<field>",\n      includArrayIndex: <field-item-index>\n    }\n  }\n])\n\n# \u5c55\u5f00\u6570\u7ec4\u65f6\u4fdd\u7559\u7a7a\u6570\u7ec4\u6216\u4e0d\u5b58\u5728\u6570\u7ec4\u7684\u6587\u6863\n$ db.<collection>.aggregate([\n  {\n    $unwind: {\n      path: "$<field>",\n      preserveNullAndEmptyArrays: true\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("h4",{id:"sort"},t.a.createElement(c["AnchorLink"],{to:"#sort","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$sort"),t.a.createElement("p",null,"\u5bf9\u6587\u6863\u6309\u7167\u6307\u5b9a\u5b57\u6bb5\u6392\u5e8f\uff0c\u4e0e\u67e5\u8be2\u6587\u6863 ",t.a.createElement("code",null,"find()")," \u65f6\u7684 ",t.a.createElement("code",null,"sort")," \u76f8\u540c\u3002"),t.a.createElement("ul",null,t.a.createElement("li",null,t.a.createElement("code",null,"1"),"\uff1a\u7531\u5c0f\u5230\u5927"),t.a.createElement("li",null,t.a.createElement("code",null,"-1"),"\uff1a\u7531\u5927\u5230\u5c0f")),t.a.createElement(r["a"],{code:'# \u5bf9\u6587\u6863\u8fdb\u884c\u6392\u5e8f\n$ db.<collection>.aggregate([\n  {\n    $sort: {\n      <field1>: <sort-number>,\n      "<field2>.<sub-field>": <sort-number>\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("h4",{id:"lookup"},t.a.createElement(c["AnchorLink"],{to:"#lookup","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$lookup"),t.a.createElement("h5",{id:"\u4f7f\u7528\u5355\u4e00\u5b57\u6bb5\u503c\u8fdb\u884c\u67e5\u8be2"},t.a.createElement(c["AnchorLink"],{to:"#\u4f7f\u7528\u5355\u4e00\u5b57\u6bb5\u503c\u8fdb\u884c\u67e5\u8be2","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u4f7f\u7528\u5355\u4e00\u5b57\u6bb5\u503c\u8fdb\u884c\u67e5\u8be2"),t.a.createElement(r["a"],{code:'$lookup: {\n  # \u540c\u4e00\u6570\u636e\u5e93\u4e2d\u7684\u53e6\u4e00\u4e2a\u67e5\u8be2\u96c6\u5408\uff08\u4e0d\u80fd\u8de8\u6570\u636e\u5e93\u67e5\u8be2\uff09\n  from: <collection to join>,\n  # \u7ba1\u9053\u6587\u6863\u4e2d\u7528\u6765\u67e5\u8be2\u7684\u5b57\u6bb5\n  localField: <field from the input docuement>,\n  # \u67e5\u8be2\u96c6\u5408\u4e2d\u7684\u67e5\u8be2\u5b57\u6bb5\n  foreignField: <field from the documents of the "from" collection>,\n  # \u5199\u5165\u7ba1\u9053\u6587\u6863\u4e2d\u7684\u67e5\u8be2\u7ed3\u679c\u6570\u7ec4\u5b57\u6bb5\n  as: <output array field>\n}\n',lang:"bash"}),t.a.createElement("p",null,"\u5982\u4e0b\u9762\u4ee3\u7801\u6240\u793a\uff1a"),t.a.createElement("p",null,"MongoDB \u4f1a\u5148\u7ba1\u9053\u67e5\u8be2 ",t.a.createElement("code",null,"<aggregation-collection>")," \u96c6\u5408\uff08\u8fd9\u91cc\u6211\u4eec\u79f0\u4e3a\u7ba1\u9053\u96c6\u5408\uff09\uff0c\u540c\u65f6\u4e5f\u4f1a\u67e5\u8be2\u53e6\u4e00\u4e2a\u96c6\u5408 ",t.a.createElement("code",null,"<find-collection>"),"\uff08\u8fd9\u91cc\u6211\u4eec\u79f0\u4e3a\u67e5\u8be2\u96c6\u5408\uff09\u3002\u5f53\u7ba1\u9053\u96c6\u5408\u6587\u6863\u4e2d\u7684\u5b57\u6bb5 ",t.a.createElement("code",null,"<aggregation-field>")," \u4e0e\u67e5\u8be2\u96c6\u5408\u6587\u6863\u4e2d\u7684\u5b57\u6bb5 ",t.a.createElement("code",null,"<find-field>")," \u76f8\u5339\u914d\u65f6\uff0c\u8fd9\u7bc7\u67e5\u8be2\u96c6\u5408\u4e2d\u7684\u6587\u6863\u5c31\u662f\u7b26\u5408\u67e5\u8be2\u6761\u4ef6\u7684\u6587\u6863\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06\u8fd9\u7bc7\u6587\u6863\u6dfb\u52a0\u5230\u7ba1\u9053\u96c6\u5408\u5bf9\u5e94\u6587\u6863\u7684 ",t.a.createElement("code",null,"<new-field>")," \u5b57\u6bb5\u4e2d\u3002\u800c ",t.a.createElement("code",null,"<new-field>")," \u7684\u5185\u5bb9\u5c31\u6839\u636e\u67e5\u8be2\u7ed3\u679c\u800c\u6709\u6240\u4e0d\u540c\uff0c"),t.a.createElement(r["a"],{code:'$ db.<aggregation-collection>.aggregate([\n  {\n    $lookup: {\n      from: "<find-collection>",\n      localField: "<aggregation-field>",\n      foreignField: "<find-field>",\n      as: "<new-field>"\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("ul",null,t.a.createElement("li",null,"\u5982\u679c\u7ba1\u9053\u96c6\u5408\u7684 ",t.a.createElement("code",null,"<local-field>")," \u5b57\u6bb5\u662f\u4e2a\u6570\u7ec4\u5b57\u6bb5\uff0c\u67e5\u8be2\u96c6\u5408\u7684 ",t.a.createElement("code",null,"<find-field>")," \u5b57\u6bb5\u662f\u5b57\u7b26\u4e32\u5b57\u6bb5\uff0c",t.a.createElement("code",null,"<local-field>")," \u591a\u4e2a\u6210\u5458\u4e0e\u67e5\u8be2\u96c6\u5408\u4e2d\u7684 ",t.a.createElement("code",null,"<find-field>")," \u76f8\u5339\u914d\uff0c\u90a3\u4e48\u4f1a\u5c06\u67e5\u8be2\u96c6\u5408\u4e2d\u8fd9\u51e0\u4e2a\u5b57\u6bb5\u5339\u914d\u7684\u6587\u6863\u7ec4\u6210\u6570\u7ec4\uff0c\u8d4b\u503c\u5230\u7ba1\u9053\u96c6\u5408\u6587\u6863\u7684 ",t.a.createElement("code",null,"<new-field>")," \u65b0\u5b57\u6bb5\u4e2d\u3002"),t.a.createElement("li",null,"\u5982\u679c\u90fd\u6ca1\u6709\u5bf9\u5e94\u7b26\u5408\u6761\u4ef6\u7684 ",t.a.createElement("code",null,"<find-collection>")," \u6587\u6863\uff0c\u90a3\u4e48 ",t.a.createElement("code",null,"<aggregation-collection>")," \u7684\u6587\u6863\u4e5f\u4f1a\u4fdd\u7559\u4e0b\u6765\uff0c\u4f46\u662f ",t.a.createElement("code",null,"<new-field>")," \u5b57\u6bb5\u4f1a\u662f\u7a7a\u6570\u7ec4")),t.a.createElement(r["a"],{code:'# \u5982\u679c localField \u662f\u4e00\u4e2a\u6570\u7ec4\u5b57\u6bb5\n# \u4f7f\u7528 $unwind \u5c06 <aggregation-collection> \u7684 <aggregation-field> \u6570\u7ec4\u5b57\u6bb5\u5c55\u5f00\n$ db.<aggregation-collection>.aggregate([\n  {\n    $unwind: {\n      path: "$<aggregation-field>"\n    }\n  },\n  {\n    $lookup: {\n      from: <find-collection>,\n      localField: <aggregation-field>,\n      foreignField: <find-field>,\n      as: <new-field>\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("p",null,"\u5148\u7ecf\u8fc7 ",t.a.createElement("code",null,"$unwind")," \u4f1a\u5148\u628a\u7ba1\u9053\u96c6\u5408\u4e2d  ",t.a.createElement("code",null,"<aggregation-collection>")," \u6587\u6863\u4e2d\u65e0\u6cd5\u5c55\u5f00\u7684 ",t.a.createElement("code",null,"<aggregation-field>")," \u5b57\u6bb5\u7684\u503c\u7684\u5bf9\u5e94\u6587\u6863\u5254\u9664\u3002"),t.a.createElement("h5",{id:"\u4f7f\u7528\u590d\u6742\u6761\u4ef6\u8fdb\u884c\u67e5\u8be2"},t.a.createElement(c["AnchorLink"],{to:"#\u4f7f\u7528\u590d\u6742\u6761\u4ef6\u8fdb\u884c\u67e5\u8be2","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u4f7f\u7528\u590d\u6742\u6761\u4ef6\u8fdb\u884c\u67e5\u8be2"),t.a.createElement("p",null,t.a.createElement("code",null,"let")," \u662f\u5728\u5bf9 ",t.a.createElement("code",null,"pipeline")," \u8fdb\u884c\u8fdb\u4e00\u6b65\u805a\u5408\u67e5\u8be2\u65f6\u9700\u8981\u7528\u5230\u539f\u7ba1\u9053\u67e5\u8be2\u65f6\u4f7f\u7528\u5230\u7684\u6587\u6863\u7684\u5b57\u6bb5\u503c\u65f6\u4f7f\u7528\u7684\uff0c\u662f\u7528\u4e8e\u5bf9\u539f\u7ba1\u9053\u67e5\u8be2\u65f6\u6240\u5728\u6587\u6863\u7684\u5b57\u6bb5\u8fdb\u884c\u518d\u6b21\u58f0\u660e\u3002"),t.a.createElement(r["a"],{code:"$lookup: {\n  from: <collection to join>,\n  # \u5bf9\u67e5\u8be2\u96c6\u5408\u4e2d\u7684\u6587\u6863\u4f7f\u7528\u805a\u5408\u9636\u6bb5\u8fdb\u884c\u5904\u7406\u65f6\uff0c\u5982\u679c\u9700\u8981\u53c2\u8003\u7ba1\u9053\u6587\u6863\u4e2d\u7684\u5b57\u6bb5\uff0c\u5219\u5fc5\u987b\u4f7f\u7528 let \u53c2\u6570\u5bf9\u5b57\u6bb5\u8fdb\u884c\u58f0\u660e\n  let: { <var_1: <expression>, ..., <var_n>: <expression> },\n  # \u5bf9\u67e5\u8be2\u96c6\u5408\u4e2d\u7684\u6587\u6863\u4f7f\u7528\u805a\u5408\u9636\u6bb5\u8fdb\u884c\u67e5\u8be2\uff08\u9488\u5bf9 from \u6307\u5b9a\u7684\u96c6\u5408\u4e2d\u7684\u6587\u6863\uff09\n  pipeline: [<pipeline to execute on the collection to join>],\n\tas: <output array field>\n}\n",lang:"bash"}),t.a.createElement("p",null,"\ud83c\udf30 ",t.a.createElement("strong",null,"\u793a\u4f8b\uff1a")),t.a.createElement(r["a"],{code:'# \u5bf9 <find-collection> \u4ee5 $match \u505a\u7b5b\u9009\u505a\u793a\u4f8b\n$ db.<aggregation-collection>.aggregate([\n  {\n    $lookup: {\n      from: <find-collection>,\n      pipeline: [\n        {\n          $match: {\n            <field>: <value>\n          }\n        }\n      ],\n      as: <new-field>\n    }\n  }\n])\n\n# <find-collection-field> \u67e5\u8be2\u96c6\u5408\u4e2d\u6587\u6863\u7684\u5b57\u6bb5\n# <var-aggregation-field> \u662f\u539f\u6587\u6863\u91cd\u65b0\u58f0\u660e\u7684\u5b57\u6bb5\uff08\u76f8\u5f53\u4e8e\u4e00\u4e2a\u95f4\u63a5\u53d8\u91cf\uff09\n$ db.<aggregation-collection>.aggregate([\n  {\n    $lookup: {\n      from: <find-collection>,\n      let: { <var-aggregation-field>: "$<aggregation-field>" },\n      # pipeline \u4e2d\u6240\u6709\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u90fd\u662f\u5e94\u7528\u5728\u67e5\u8be2\u96c6\u5408\n      pipeline: [\n        {\n          $match: {\n            $expr: {\n              $and: [\n                { $eq: [ "$<find-collection-field>", <value1> ] },\n                { $gt: [ "$$<var-aggregation-field>", <value2> ] }\n              ]\n            }\n          }\n        }\n      ],\n      as: <new-field>\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("h4",{id:"group"},t.a.createElement(c["AnchorLink"],{to:"#group","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$group"),t.a.createElement("p",null,"\u4f7f\u7528 ",t.a.createElement("code",null,"$group")," \u64cd\u4f5c\u7b26\u5fc5\u987b\u6307\u5b9a ",t.a.createElement("code",null,"_id")," \u57df\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u7b97\u672f\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\u3002"),t.a.createElement(r["a"],{code:"$group: {\n  # \u5b9a\u4e49\u5206\u7ec4\u89c4\u5219\n  _id: <expression>,\n  # \u53ef\u4ee5\u4f7f\u7528\u805a\u5408\u64cd\u4f5c\u7b26\u6765\u5b9a\u4e49\u65b0\u5b57\u6bb5\n  <field1>: { <accumulator1>: <expression1> },\n  ...\n}\n",lang:"bash"}),t.a.createElement("p",null,"\ud83c\udf30 ",t.a.createElement("strong",null,"\u793a\u4f8b\uff1a")),t.a.createElement("p",null,"\u901a\u8fc7\u7ba1\u9053\u96c6\u5408\u7684 ",t.a.createElement("code",null,"<collection-field>")," \u5b57\u6bb5\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7ec4\u3002"),t.a.createElement("p",null,"\u4e0d\u5b9e\u7528\u805a\u5408\u64cd\u4f5c\u7b26\u7684\u60c5\u51b5\u4e0b\uff0c",t.a.createElement("code",null,"$group")," \u53ef\u4ee5\u8fd4\u56de\u7ba1\u9053\u6587\u6863\u4e2d\u67d0\u4e00\u5b57\u6bb5\u7684\u6240\u6709\uff08\u4e0d\u91cd\u590d\u7684\uff09\u503c\u3002"),t.a.createElement(r["a"],{code:'# \u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\n$ db.<collection>.aggregate([\n  {\n    $group: {\n      <new-field>: "$<collection-field>"\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("p",null,"\u4e0b\u9762\u4ee5\u5b9e\u9645\u4f8b\u5b50\u6f14\u793a\uff1a"),t.a.createElement(r["a"],{code:'# \u9ad8\u7ea7\u7528\u6cd5\uff0c\u4f7f\u7528\u805a\u5408\u64cd\u4f5c\u7b26\u8ba1\u7b97\u5206\u7ec4\u805a\u5408\u503c\n$ db.<collection>.aggregate([\n  {\n    $group: {\n      # \u8d4b\u503c\u4e3a null \u65f6\uff0c\u4e0d\u4f1a\u5206\u7ec4\uff0c\u6240\u6709\u7ba1\u9053\u6587\u6863\u5206\u4e3a\u4e00\u7ec4\n      _id: "$currency",\n      # \u6bcf\u7bc7\u6587\u6863\u7684 qty \u5b57\u6bb5\u6c42\u548c\u7ed3\u679c\uff0c\u8d4b\u503c totalQty \u65b0\u5b57\u6bb5\n      totalQty: { $sum: "$qty" },\n      # \u6bcf\u7bc7\u6587\u6863\u7684 price \u548c qty \u7684\u4e58\u79ef\u7684\u6c42\u548c\u7ed3\u679c\n      totalNotional: { $sum: { $multiply: [ "$price", "$qty" ] } },\n      # \u6bcf\u7bc7\u6587\u6863\u7684 price \u5b57\u6bb5\u6c42\u5f97\u5e73\u5747\u6570\n      avgPrice: { $avg: "$price" },\n      # \u6bcf\u7bc7\u6587\u6863 +1\uff0c\u591a\u5c11\u7bc7\u5c31\u52a0\u591a\u5c11\u6b21\uff0c\u96c6\u5408\u6587\u6863\u7684\u603b\u6570\n      count: { $sum: 1 },\n      # \u627e\u5230\u5206\u7ec4\u4e2d\u67d0\u4e2a\u8868\u8fbe\u5f0f\u4e2d\u6700\u5927\u7684\u503c\n      maxNotional: { $max: { $multiply: [ "$price", "$qty" ] } },\n      #\u627e\u5230\u5206\u7ec4\u4e2d\u67d0\u4e2a\u8868\u8fbe\u5f0f\u4e2d\u6700\u5c0f\u7684\u503c\n      minNotional: { $min: { $multiply: [ "$price", "$qty" ] } },\n    }\n  }\n])\n',lang:"bash"}),t.a.createElement("p",null,"\u26a0\ufe0f ",t.a.createElement("strong",null,"\u6ce8\u610f\u4e8b\u9879\uff1a")),t.a.createElement("ul",null,t.a.createElement("li",null,t.a.createElement("code",null,"$group")," \u7684\u8f93\u51fa\u662f\u65e0\u5e8f\u7684"),t.a.createElement("li",null,t.a.createElement("code",null,"$group")," \u64cd\u4f5c\u76ee\u524d\u662f\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u7528\u5b83\u6765\u5bf9\u5927\u91cf\u4e2a\u6570\u7684\u6587\u6863\u8fdb\u884c\u5206\u7c7b"),t.a.createElement("li",null,"\u5fc5\u987b\u6307\u5b9a ",t.a.createElement("code",null,"_id")," \u57df")),t.a.createElement("h4",{id:"out"},t.a.createElement(c["AnchorLink"],{to:"#out","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"$out"),t.a.createElement("p",null,"\u521b\u5efa\u6307\u5b9a\u526f\u672c\u96c6\u5408"),t.a.createElement(r["a"],{code:'$ db.<collection>.aggregate([\n  {\n    $group: {\n      _id: "$<field1>",\n      # <field2> \u662f\u6570\u7ec4\u5b57\u6bb5\n      <new-field>: { $push: "$<field2>" }\n    }\n  },\n  {\n    # \u526f\u672c\u96c6\u5408\u540d\u79f0\n    $out: "output"\n  }\n])\n',lang:"bash"}),t.a.createElement("p",null,"\ud83c\udf30 ",t.a.createElement("strong",null,"\u5b9e\u4f8b\uff1a")),t.a.createElement(r["a"],{code:'# \u5df2\u6709\u96c6\u5408\n{ "_id" : 8751, "title" : "The Banquet", "author" : "Dante", "copies" : 2 }\n{ "_id" : 8752, "title" : "Divine Comedy", "author" : "Dante", "copies" : 1 }\n{ "_id" : 8645, "title" : "Eclogues", "author" : "Dante", "copies" : 2 }\n{ "_id" : 7000, "title" : "The Odyssey", "author" : "Homer", "copies" : 10 }\n{ "_id" : 7020, "title" : "Iliad", "author" : "Homer", "copies" : 10 }\n\n# \u6309\u7167 author \u5206\u7ec4\uff0c\u7136\u540e out \u4e00\u4e2a\u65b0\u96c6\u5408 authors\n$ db.books.aggregate([\n  { $group: { _id: "$author", books: { $push: "$title" } } },\n  { $out: "authors" }\n])\n\n# \u67e5\u8be2\u7ed3\u679c\n { "_id" : "Homer", "books" : [ "The Odyssey", "Iliad" ] }\n { "_id" : "Dante", "books" : [ "The Banquet", "Divine Comedy", "Eclogues" ] }\n',lang:"bash"}),t.a.createElement("h3",{id:"\u914d\u7f6e\u9879"},t.a.createElement(c["AnchorLink"],{to:"#\u914d\u7f6e\u9879","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u914d\u7f6e\u9879"),t.a.createElement("p",null,"\u6bcf\u4e2a\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u4f7f\u7528\u7684\u5185\u5b58\u4e0d\u80fd\u8d85\u8fc7 100MB\u3002"),t.a.createElement("p",null,"\u5982\u679c\u6570\u636e\u91cf\u8f83\u5927\uff0c\u4e3a\u4e86\u9632\u6b62\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u8d85\u51fa\u5185\u5b58\u4e0a\u9650\u5e76\u4e14\u629b\u51fa\u9519\u8bef\uff0c\u53ef\u4ee5\u542f\u7528 ",t.a.createElement("code",null,"allowDiskUse")," \u9009\u9879\u3002"),t.a.createElement("p",null,t.a.createElement("code",null,"allowDishUse")," \u542f\u7528\u4e4b\u540e\uff0c\u805a\u5408\u9636\u6bb5\u53ef\u4ee5\u518d\u5185\u5b58\u5bb9\u91cf\u4e0d\u8db3\u65f6\uff0c\u5c06\u64cd\u4f5c\u6570\u636e\u5199\u5165\u4e34\u65f6\u6587\u4ef6\u4e2d\u3002"),t.a.createElement("p",null,"\u4e34\u65f6\u6587\u4ef6\u4f1a\u88ab\u5199\u5165 ",t.a.createElement("code",null,"dbPath")," \u4e0b\u7684 ",t.a.createElement("code",null,"_tmp")," \u6587\u4ef6\u5939\uff0c",t.a.createElement("code",null,"dbPath")," \u7684\u9ed8\u8ba4\u503c\u4e3a ",t.a.createElement("code",null,"/data/db"),"\u3002"),t.a.createElement("h2",{id:"\u805a\u5408\u64cd\u4f5c\u7684\u4f18\u5316"},t.a.createElement(c["AnchorLink"],{to:"#\u805a\u5408\u64cd\u4f5c\u7684\u4f18\u5316","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u805a\u5408\u64cd\u4f5c\u7684\u4f18\u5316"),t.a.createElement("h3",{id:"\u987a\u5e8f\u4f18\u5316"},t.a.createElement(c["AnchorLink"],{to:"#\u987a\u5e8f\u4f18\u5316","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u987a\u5e8f\u4f18\u5316"),t.a.createElement("h4",{id:"project--match"},t.a.createElement(c["AnchorLink"],{to:"#project--match","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),t.a.createElement("code",null,"$project")," + ",t.a.createElement("code",null,"$match")),t.a.createElement("p",null,"\u65e2\u9700\u8981\u4f7f\u7528 ",t.a.createElement("code",null,"$project"),"\uff0c\u4e5f\u9700\u8981 ",t.a.createElement("code",null,"$match")," \u9636\u6bb5\uff0cMongoDB \u5728\u8fd0\u884c\u805a\u5408\u7ba1\u9053\u4ee3\u7801\u65f6\uff0c\u5c3d\u91cf\u628a ",t.a.createElement("code",null,"$match")," \u9636\u6bb5\u8bbe\u7f6e\u5728 ",t.a.createElement("code",null,"$project")," \u9636\u6bb5\u4e4b\u524d\u8fd0\u884c\u3002\u56e0\u4e3a ",t.a.createElement("code",null,"$match")," \u662f\u5bf9\u6587\u6863\u8fdb\u884c\u7b5b\u9009\uff0c\u6240\u4ee5 ",t.a.createElement("code",null,"$match")," \u9636\u6bb5\u5f88\u6709\u53ef\u80fd\u51cf\u5c11\u6587\u6863\u6570\u91cf\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u8981\u5c3d\u91cf\u51cf\u5c11\u64cd\u4f5c\u91cf\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5c3d\u53ef\u80fd\u65e9\u5730\u9636\u6bb5\u51cf\u5c11\u6587\u6863\u8fdb\u5165\u540e\u7eed\u7684\u9636\u6bb5\u3002"),t.a.createElement("h4",{id:"sort--match"},t.a.createElement(c["AnchorLink"],{to:"#sort--match","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),t.a.createElement("code",null,"$sort")," + ",t.a.createElement("code",null,"$match")),t.a.createElement("p",null,"\u540c\u7406\uff0c\u628a ",t.a.createElement("code",null,"$match")," \u63d0\u524d\u5230 ",t.a.createElement("code",null,"$sort")," \u9636\u6bb5\u524d\uff0c\u80fd\u6709\u6548\u4f18\u5316\u3002"),t.a.createElement("h4",{id:"project--skip"},t.a.createElement(c["AnchorLink"],{to:"#project--skip","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),t.a.createElement("code",null,"$project")," + ",t.a.createElement("code",null,"$skip")),t.a.createElement("p",null,t.a.createElement("code",null,"$skip")," \u9636\u6bb5\u5728 ",t.a.createElement("code",null,"$project")," \u9636\u6bb5\u4e4b\u524d\u8fd0\u884c\u3002"),t.a.createElement("h3",{id:"\u5408\u5e76\u4f18\u5316"},t.a.createElement(c["AnchorLink"],{to:"#\u5408\u5e76\u4f18\u5316","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),"\u5408\u5e76\u4f18\u5316"),t.a.createElement("h4",{id:"sort--limit"},t.a.createElement(c["AnchorLink"],{to:"#sort--limit","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),t.a.createElement("code",null,"$sort")," + ",t.a.createElement("code",null,"$limit")),t.a.createElement("p",null,"\u5982\u679c\u4e24\u8005\u4e4b\u95f4\u6ca1\u6709\u5939\u6742\u7740\u6539\u53d8\u6587\u6863\u6570\u91cf\u7684\u805a\u5408\u9636\u6bb5\uff0c",t.a.createElement("code",null,"$sort")," \u548c ",t.a.createElement("code",null,"$limit")," \u9636\u6bb5\u53ef\u4ee5\u5408\u5e76\u3002"),t.a.createElement("p",null,"\u540c\u7c7b\u578b\u7684\uff0c\u5982\u4e0b\u7ec4\u5408\u4e5f\u53ef\u4ee5\u8fdb\u884c\u4f18\u5316\uff1a"),t.a.createElement("ul",null,t.a.createElement("li",null,t.a.createElement("code",null,"$limit")," + ",t.a.createElement("code",null,"$limit")),t.a.createElement("li",null,t.a.createElement("code",null,"$skip")," + ",t.a.createElement("code",null,"$skip")),t.a.createElement("li",null,t.a.createElement("code",null,"$match")," + ",t.a.createElement("code",null,"$match"))),t.a.createElement("p",null,"\u8fde\u7eed\u7684 ",t.a.createElement("code",null,"$limit"),"\u3001",t.a.createElement("code",null,"$skip")," \u6216 ",t.a.createElement("code",null,"$skip")," \u9636\u6bb5\u6392\u5217\u5728\u4e00\u8d77\u65f6\uff0c\u53ef\u4ee5\u5408\u5e76\u4e3a\u4e00\u4e2a\u9636\u6bb5\u3002"),t.a.createElement("h4",{id:"lookup-\u548c-unwind"},t.a.createElement(c["AnchorLink"],{to:"#lookup-\u548c-unwind","aria-hidden":"true",tabIndex:-1},t.a.createElement("span",{className:["icon","icon-link"]})),t.a.createElement("code",null,"$lookup")," \u548c ",t.a.createElement("code",null,"$unwind")),t.a.createElement("p",null,"\u8fde\u7eed\u6392\u5217\u5728\u4e00\u8d77\u7684 ",t.a.createElement("code",null,"$lookup")," \u548c ",t.a.createElement("code",null,"$unwind")," \u9636\u6bb5\uff0c\u5982\u679c ",t.a.createElement("code",null,"$unwind")," \u5e94\u7528\u5728 ",t.a.createElement("code",null,"$lookup")," \u9636\u6bb5\u521b\u5efa\u7684 ",t.a.createElement("code",null,"as")," \u5b57\u6bb5\u4e0a\uff0c\u5219\u4e24\u8005\u53ef\u4ee5\u5408\u5e76\u3002"),t.a.createElement("hr",null),t.a.createElement("p",null,t.a.createElement("strong",null,"\u53c2\u8003\u8d44\u6599\uff1a")),t.a.createElement("ul",null,t.a.createElement("li",null,t.a.createElement("p",null,t.a.createElement(c["Link"],{to:"https://juejin.im/post/5ba8acb9e51d45395d4ee4d1"},"MongoDB \u805a\u5408\u7ba1\u9053"))),t.a.createElement("li",null,t.a.createElement("p",null,t.a.createElement(c["Link"],{to:"https://www.cnblogs.com/clschen/p/5523897.html"},"MongoDB \u5317\u5927\u7eff\u5361\u4e4b\u5b89\u5168\u5efa\u8bae"))),t.a.createElement("li",null,t.a.createElement("p",null,t.a.createElement(c["Link"],{to:"https://t-baby.gitbooks.io/mongodb-plugin/content/ju_he_yun_suan.html"},"\u805a\u5408\u8fd0\u7b97"))),t.a.createElement("li",null,t.a.createElement("p",null,t.a.createElement(c["Link"],{to:"https://laixiazheteng.com/article/page/id/Bj7qgmJ3CJUE"},"MongoDB \u5e38\u7528\u8bed\u53e5"))),t.a.createElement("li",null,t.a.createElement("p",null,t.a.createElement(c["Link"],{to:"https://blog.csdn.net/congcong68/article/details/51620040"},"\u5b66\u4e60 MongoDB \u805a\u5408 Aggregation Pipeline \u57fa\u7840\u7bc7")))),t.a.createElement("p",null,t.a.createElement(c["Link"],{to:"https://segmentfault.com/a/1190000020685264?utm_source=tag-newest"},"https://segmentfault.com/a/1190000020685264?utm_source=tag-newest")))))}},fyah:function(e,n,a){e.exports=a.p+"static/mongodb-aggregation.d9fbbcf4.jpg"},vg9a:function(e,n,a){}}]);