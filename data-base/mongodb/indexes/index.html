<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/devops-guidebook/umi.css" />
    <script>
      window.routerBase = "/devops-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.9
    </script>
    <title>&#x6570;&#x636E;&#x5E93;&#x7D22;&#x5F15;</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/favicon.png&#x27;)" href="/devops-guidebook//">DevOps Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/devops-guidebook//linux">Linux</a><a href="/devops-guidebook//server">服务器</a><a aria-current="page" class="active" href="/devops-guidebook//data-base">数据库</a><a href="/devops-guidebook//deploy">部署</a><a href="/devops-guidebook//version">版本管理</a><a href="/devops-guidebook//devops">DevOps</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/favicon.png&#x27;)" href="/devops-guidebook//"></a><h1>DevOps Guidebook</h1><p>DevOps 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/devops-guidebook//linux">Linux</a></li><li><a href="/devops-guidebook//server">服务器</a></li><li><a aria-current="page" class="active" href="/devops-guidebook//data-base">数据库</a></li><li><a href="/devops-guidebook//deploy">部署</a></li><li><a href="/devops-guidebook//version">版本管理</a></li><li><a href="/devops-guidebook//devops">DevOps</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/devops-guidebook//data-base">数据库</a></li><li><a href="/devops-guidebook//data-base/no-sql">NoSQL</a></li><li><a aria-current="page" class="active" href="/devops-guidebook//data-base/mongodb">MongoDB</a><ul><li><a href="/devops-guidebook//data-base/mongodb/overview"><span>基本概述</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/installment"><span>安裝使用</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/basic-usage"><span>基本操作</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/backup-and-recovery"><span>备份与恢复</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/aggregation"><span>聚合管道</span></a></li><li><a aria-current="page" class="active" href="/devops-guidebook//data-base/mongodb/indexes"><span>数据库索引</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/data-models"><span>数据模型</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/replication"><span>数据库副本集</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/sharding"><span>数据库分片</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/administration"><span>数据库管理</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/security"><span>数据库安全</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/configuration"><span>配置文件</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/command"><span>命令大全</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/mongodb"><span>扩展资料</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/authentication"><span>鉴权</span></a></li><li><a href="/devops-guidebook//data-base/mongodb/shard-key"><span>片键</span></a></li></ul></li><li><a href="/devops-guidebook//data-base/mysql">MySQL</a><ul><li><a href="/devops-guidebook//data-base/mysql/mysql"><span>MySQL</span></a></li><li><a href="/devops-guidebook//data-base/mysql/cluster"><span>集群方案</span></a></li></ul></li><li><a href="/devops-guidebook//data-base/radis">Radis</a></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="索引类型" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#索引类型"><span>索引类型</span></a></li><li title="单键索引" data-depth="3" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#单键索引"><span>单键索引</span></a></li><li title="复合键索引" data-depth="3" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#复合键索引"><span>复合键索引</span></a></li><li title="多键索引" data-depth="3" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#多键索引"><span>多键索引</span></a></li><li title="索引特性" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#索引特性"><span>索引特性</span></a></li><li title="唯一性" data-depth="3" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#唯一性"><span>唯一性</span></a></li><li title="稀疏性" data-depth="3" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#稀疏性"><span>稀疏性</span></a></li><li title="生存时间" data-depth="3" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#生存时间"><span>生存时间</span></a></li><li title="索引的选择" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#索引的选择"><span>索引的选择</span></a></li><li title="创建索引" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#创建索引"><span>创建索引</span></a></li><li title="查看索引" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#查看索引"><span>查看索引</span></a></li><li title="删除索引" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#删除索引"><span>删除索引</span></a></li><li title="索引效果" data-depth="2" class=""><a href="/devops-guidebook//data-base/mongodb/indexes#索引效果"><span>索引效果</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="数据库索引"><a aria-hidden="true" href="#数据库索引"><span class="icon icon-link"></span></a>数据库索引</h1><p><strong>索引</strong>是对指定字段进行排序的数据结构。</p><p>在 Mongodb 典型的数据库查询场景中，索引 index 扮演着非常重要的作用，如果没有索引，MongoDB 需要为了找到一个匹配的文档而扫描整个 collection，代价非常高昂。</p><p>Mongodb 的索引使用的 B-tree 这一特殊的数据结构，借助索引 Mongodb 可以高效的匹配到需要查询的数据：</p><p>作者：wecatch 链接：<a href="https://juejin.im/post/5ad1d2836fb9a028dd4eaae6" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5ad1d2836fb9a028dd4eaae6<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>来源：掘金 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><p><img src="/devops-guidebook/static/mongodb-indexes.1a47c2b4.jpg"/></p><ul><li>索引通常能够极大的提高查询的效率，如果没有索引，MongoDB 在读取数据时必须扫描集合中的每个文件并选取那些符合查询条件的记录。</li><li>这种扫描全集合的查询效率是非常低的，特别在处理大量的数据时，查询可以要花费几十秒甚至几分钟，这对网站的性能是非常致命的。</li><li>索引是特殊的数据结构，索引存储在一个易于遍历读取的数据集合中，索引是对数据库表中一列或多列的值进行排序的一种结构</li></ul><p><strong>复合键索引可以对多个字段进行排序</strong></p><p>合适的索引可以大大提升数据库搜索性能</p><p>集合层面的索引</p><h2 id="索引类型"><a aria-hidden="true" href="#索引类型"><span class="icon icon-link"></span></a>索引类型</h2><h3 id="单键索引"><a aria-hidden="true" href="#单键索引"><span class="icon icon-link"></span></a>单键索引</h3><p><img src="/devops-guidebook/static/mongodb-single-index.e8330bad.jpg"/></p><h3 id="复合键索引"><a aria-hidden="true" href="#复合键索引"><span class="icon icon-link"></span></a>复合键索引</h3><p><img src="/devops-guidebook/static/mongodb-compound-index.64072859.jpg"/></p><h3 id="多键索引"><a aria-hidden="true" href="#多键索引"><span class="icon icon-link"></span></a>多键索引</h3><h2 id="索引特性"><a aria-hidden="true" href="#索引特性"><span class="icon icon-link"></span></a>索引特性</h2><h3 id="唯一性"><a aria-hidden="true" href="#唯一性"><span class="icon icon-link"></span></a>唯一性</h3><p>文档主键上创建的默认索引 <code>_id</code>。</p><p>手动创建一个具有唯一性的索引</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="# 设置 unique 使得 &lt;field&gt; 具有唯一性
# 写入文档的每一个 &lt;field&gt; 字段的值都要是不同的，不可能存在相同字段值的文档
$ db.&lt;collection /&gt;.createIndex({ &lt;field&gt;: &lt;sort-value&gt; }, { unique: true })
" data-status="copy"></button><div class="token-line"><span class="token comment"># 设置 unique 使得 &lt;field&gt; 具有唯一性</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 写入文档的每一个 &lt;field&gt; 字段的值都要是不同的，不可能存在相同字段值的文档</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">field</span><span class="token operator">&gt;</span><span class="token plain">: </span><span class="token operator">&lt;</span><span class="token plain">sort-value</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain">, </span><span class="token punctuation">{</span><span class="token plain"> unique: </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>如果已有文档中的某个字段出现了重复值，就不可以再这个字段上创建唯一性索引。</p><p>如果新增的文档不包含唯一性索引字段，只有第一篇缺失该字段的文档可以被写入数据看，索引中该文档的键值呗默认为 <code>null</code>。</p><p>符合键索引也可以具有唯一性，在这种情况下，不同的文档之间，其所包含的符合键字段值的组合，不可以重复。</p><h3 id="稀疏性"><a aria-hidden="true" href="#稀疏性"><span class="icon icon-link"></span></a>稀疏性</h3><p>只将包含索引键字段的文档加入到索引中（即使索引键字段值为 <code>null</code>）</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ db.&lt;collection /&gt;.createIndex({ &lt;field&gt;: &lt;sort-value&gt; }, { sparse: true })
" data-status="copy"></button><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">field</span><span class="token operator">&gt;</span><span class="token plain">: </span><span class="token operator">&lt;</span><span class="token plain">sort-value</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain">, </span><span class="token punctuation">{</span><span class="token plain"> sparse: </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>如果同一个索引既具有唯一性，又具有稀疏性，就可以保存多篇缺失索引键值的文档了。</p><p>复合键索引也可以具有稀疏性，在这种情况下，只有在缺失复合键所包含的所有字段的情况下，文档才不会被加入到索引中。</p><h3 id="生存时间"><a aria-hidden="true" href="#生存时间"><span class="icon icon-link"></span></a>生存时间</h3><p>针对日期字段，或者包含日期元素的数组字段，可以使用设定了生存时间的索引，来自动删除字段值超过生存时间的文档。</p><p>索引的生存时间只应用单键索引，而复合键索引不具备生存时间特性。</p><p>当索引键是包含日期元素的数组字段时，数组中最小的日期将被用来计算文档是否已经过期。</p><p>数据库使用一个后台线程来检测和删除过期的文档，删除操作可能有一定的延迟。</p><h2 id="索引的选择"><a aria-hidden="true" href="#索引的选择"><span class="icon icon-link"></span></a>索引的选择</h2><ul><li>如何创建一个合适的索引</li><li>索引对数据写入操作的影响</li></ul><h2 id="创建索引"><a aria-hidden="true" href="#创建索引"><span class="icon icon-link"></span></a>创建索引</h2><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="# &lt;keys&gt; 参数指定了创建索引的文档字段
$ db.&lt;collection /&gt;.createIndex(&lt;keys&gt;, &lt;options&gt;)


" data-status="copy"></button><div class="token-line"><span class="token comment"># &lt;keys&gt; 参数指定了创建索引的文档字段</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.createIndex</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token plain">keys</span><span class="token operator">&gt;</span><span class="token plain">, </span><span class="token operator">&lt;</span><span class="token plain">options</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>创建单键索引</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="# 创建一个单键索引
$ db.&lt;collection /&gt;.createIndex({ &lt;field&gt;: &lt;value&gt; })

# 列出集合中已存在的索引
$ db.&lt;collection /&gt;.getIndexes()
" data-status="copy"></button><div class="token-line"><span class="token comment"># 创建一个单键索引</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">field</span><span class="token operator">&gt;</span><span class="token plain">: </span><span class="token operator">&lt;</span><span class="token plain">value</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 列出集合中已存在的索引</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>创建复合键索引</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ db.&lt;collection /&gt;.createIndex({ &lt;field1&gt;: &lt;sort-value1&gt;, &lt;field2&gt;: &lt;sort-value2&gt; })
" data-status="copy"></button><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">field</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">: </span><span class="token operator">&lt;</span><span class="token plain">sort-value</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">, </span><span class="token operator">&lt;</span><span class="token plain">field</span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">: </span><span class="token operator">&lt;</span><span class="token plain">sort-value</span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>创建多键索引</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="# &lt;field&gt; 字段为数组类型字段
# &lt;sort-value&gt; 为 1 时正向排序
$ db.&lt;collection /&gt;.createIndex({ &lt;field&gt;: &lt;sort-value&gt; })
" data-status="copy"></button><div class="token-line"><span class="token comment"># &lt;field&gt; 字段为数组类型字段</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># &lt;sort-value&gt; 为 1 时正向排序</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">field</span><span class="token operator">&gt;</span><span class="token plain">: </span><span class="token operator">&lt;</span><span class="token plain">sort-value</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>&lt;options&gt;</code> 文档定义了创建索引时可以使用的一些参数。<code>&lt;options&gt;</code> 文档也可以设定索引的特性。</p><h2 id="查看索引"><a aria-hidden="true" href="#查看索引"><span class="icon icon-link"></span></a>查看索引</h2><h2 id="删除索引"><a aria-hidden="true" href="#删除索引"><span class="icon icon-link"></span></a>删除索引</h2><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="$ db.&lt;collection /&gt;.dropIndex()
" data-status="copy"></button><div class="token-line"><span class="token plain">$ db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.dropIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>如果需要更改某些字段上已经创建的索引，必须首先删除原有索引，再重新创建新索引，否则新索引不会包含原有文档。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="# 可以通过名称删除索引，例如删除 name 字段
db.&lt;collection /&gt;.dropIndex(&quot;name_1&quot;)

# 可以通过对象键值删除索引，同样是删除 name 字段
db.&lt;collection /&gt;.dropIndex({ name: 1 })
" data-status="copy"></button><div class="token-line"><span class="token comment"># 可以通过名称删除索引，例如删除 name 字段</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.dropIndex</span><span class="token punctuation">(</span><span class="token string">&quot;name_1&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 可以通过对象键值删除索引，同样是删除 name 字段</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">db.</span><span class="token operator">&lt;</span><span class="token plain">collection /</span><span class="token operator">&gt;</span><span class="token plain">.dropIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> name: </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="索引效果"><a aria-hidden="true" href="#索引效果"><span class="icon icon-link"></span></a>索引效果</h2><p><code>db.&lt;collection&gt;.explain().&lt;method(...)&gt;</code></p><p>可以使用 <code>explain</code> 进行分析的命令包括 <code>aggregate()</code>、<code>count()</code>、<code>distinct()</code>、<code>find()</code>、<code>group()</code>。</p><p>winningPlan 数据库认为最有效的查询方法</p><ul><li>COLLSCAN 低效查询</li><li>IXSCAN 高效</li></ul><ul><li><a href="https://juejin.im/post/5cc455f5f265da0389329c3b" target="_blank" rel="noopener noreferrer">MongoDB 索引与优化详解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook/edit/master/docs/data-base/mongodb/indexes.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">7/30/2020, 1:26:00 PM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/devops-guidebook/umi.js"></script>
    <script src="/devops-guidebook/docs__data-base__mongodb__indexes.md.js"></script>
  </body>
</html>
